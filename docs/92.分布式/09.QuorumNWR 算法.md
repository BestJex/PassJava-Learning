





# 太上老君的八卦炉之分布式 Quorum NWR

> **太白金星**：听闻老君最近在练神丹妙药，可否与我一讲？
>
> **太上老君**：老白啊，我最近在练六颗丹药：两颗`延年丹`、两颗`健步丹`、两颗`恢复丹`。
>
> **太白金星**：那这三个八卦炉定是练这三件法宝的了？
>
> **太上老君**：正是正是。而且对于相同的丹药，功效还得完全一样。

## 三个八卦炉怎么分配的

> **太白金星**：老君，你的八卦炉怎么分配的啊？

让我们揭开老君的炼丹炉，看看六颗丹药是怎么分配的。

首先我们是很容易猜到丹炉是怎么分配炼丹的：

- 一号丹炉炼两颗`延年丹`。
- 二号丹炉炼两颗`健步丹`。
- 三号丹炉炼两颗`恢复丹`。

那如此分配会有什么问题呢？

我们试想一下，如果一号丹炉因为炉火太高炸裂了，那么两颗延年丹定会失败。这和把鸡蛋放到一个篮子里面是一个道理。假如篮子不慎被打翻，里面的鸡蛋都掉出来，就都碎了。

> **太上老君**：老白，我把锅炉的盖子揭开给你看看你就知道了。

- 一号丹炉炼一颗`延年丹`和一颗`健步丹`。
- 二号丹炉炼一颗`延年丹`和一颗`恢复丹`。
- 三号丹炉炼一颗`健步丹`和一颗`恢复丹`。

> 太白金星：老君，为何要如此分配，每个丹药的火候可不那么好把控啊？
>
> 太上老君：老白，我可是炼丹大师，火候难不倒我。
>
> 太白金星：不亏是老君啊，这样即使有一个丹炉有问题，至少能保证一颗能炼成，而不是两颗都毁了。

映射到我们互联网系统中：丹炉类似于服务器节点或数据库节点，通过多个节点来相互备份数据来保证系统的`高可用性`（High Availability）。



N 表示集群中同一份数据有多少个副本，

W，又称写一致性级别（Write Consistency Level），表示成功完成 W 个副本更新，才完成写操作：

R，又称读一致性级别（Read Consistency Level），表示读取一个数据对象时需要读 R 个副本。

